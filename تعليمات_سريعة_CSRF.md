# ๐ ุชุนูููุงุช ุณุฑูุนุฉ ูุญู ูุดููุฉ CSRF

## โก 3 ุฎุทูุงุช ููุท!

---

## ุงูุฎุทูุฉ 1๏ธโฃ: ุฃุถู ุฅูู ููู `.env`

```bash
# ุงูุชุญ Terminal ููุง
cd tf1-backend

# ุงูุชุญ ููู .env
notepad .env
```

**ุงูุณุฎ ูุงูุตู ูุฐู ุงูุฃุณุทุฑ ูู ููุงูุฉ ุงูููู:**

```bash
# ==============================================
# CSRF PROTECTION
# ==============================================
CSRF_SECRET=314c505cdb3e165a87b041461d02a40cf17e82113be58fc757336a7b53db6e8d
CSRF_TOKEN_TTL_MS=3600000

# ==============================================
# CORS ORIGINS
# ==============================================
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5000,http://127.0.0.1:3000
FRONTEND_URL=http://localhost:3000
NODE_ENV=development
```

**ุงุญูุธ ุงูููู** (Ctrl+S)

---

## ุงูุฎุทูุฉ 2๏ธโฃ: ุฃุนุฏ ุชุดุบูู ุงูุณูุฑูุฑ

```powershell
# ุฃููู ุงูุณูุฑูุฑ ุงูุญุงูู (Ctrl+C)
# ุซู ุดุบูู ูู ุฌุฏูุฏ:
npm run dev
```

---

## ุงูุฎุทูุฉ 3๏ธโฃ: ุงุฎุชุจุฑ ุงููุธุงู

### ุทุฑููุฉ 1: ุงุฎุชุจุงุฑ ุณุฑูุน ูู Terminal

```powershell
curl http://localhost:4000/api/v1/auth/csrf-diagnostic
```

**ูุฌุจ ุฃู ุชุดุงูุฏ:**
```json
{
  "status": "OK",
  "csrf": {
    "secretConfigured": true,
    "tokenGenerated": true
  }
}
```

### ุทุฑููุฉ 2: ุงุฎุชุจุงุฑ ูู ุงููุชุตูุญ

ุงูุชุญ ุงูููู: **`test-csrf.html`** ูู ุงููุชุตูุญ

ุซู ุงุถุบุท ุนูู ุฌููุน ุงูุฃุฒุฑุงุฑ ููุงุฎุชุจุงุฑ!

### ุทุฑููุฉ 3: ุงุฎุชุจุงุฑ ุชููุงุฆู ูุงูู

```powershell
.\test-csrf.ps1
```

---

## โ ูู ูุฌุญุช ุงูุงุฎุชุจุงุฑุงุช

**ูุจุฑูู! ๐ ูุธุงู CSRF ูุนูู ุจุดูู ุตุญูุญ!**

ุงูุขู ููููู:

### ููู Frontend (ุงุฎุชุฑ ูุงุญุฏุฉ):

#### ุฃ) React Hook (ุงูุฃุณูู!)
```bash
# ุงูุณุฎ ุงูููู
copy frontend\useCSRF.tsx ..\path\to\your\frontend\src\hooks\

# ุงุณุชุฎุฏูู:
import { useCSRF } from '@/hooks/useCSRF';
const { fetchWithCSRF } = useCSRF();
```

#### ุจ) Axios (ุงูุฃูุถู ูููุดุงุฑูุน ุงููุจูุฑุฉ)
```bash
# ุงูุณุฎ ุงูููู
copy frontend\axios-csrf.ts ..\path\to\your\frontend\src\api\

# ุงุณุชุฎุฏูู:
import { api } from '@/api/axios-csrf';
await api.post('/api/v1/auth/login', { email, password });
```

---

## โ ูู ุธูุฑุช ุฃุฎุทุงุก

### ุฎุทุฃ: "CSRF_SECRET not configured"
```bash
โ ุชุฃูุฏ ูู ุฅุถุงูุฉ CSRF_SECRET ุฅูู .env
โ ุชุฃูุฏ ูู ุญูุธ ุงูููู
โ ุฃุนุฏ ุชุดุบูู ุงูุณูุฑูุฑ
```

### ุฎุทุฃ: "Origin not allowed"
```bash
โ ุฃุถู ุนููุงู frontend ุฅูู ALLOWED_ORIGINS
โ ูุซุงู: ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5000
```

### ุฎุทุฃ: "Connection refused"
```bash
โ ุชุฃูุฏ ูู ุชุดุบูู ุงูุณูุฑูุฑ
โ ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู ุงููููุฐ ุงูุตุญูุญ (4000)
```

---

## ๐ ูุฒูุฏ ูู ุงููุณุงุนุฏุฉุ

| ุงูููู | ูุชู ุชูุฑุฃู |
|------|-----------|
| **START_HERE_CSRF.md** | ุฏููู ุณุฑูุน (5 ุฏูุงุฆู) |
| **CSRF_QUICK_FIX.md** | ุฏููู ููุตู ูุน ุญููู |
| **CSRF_COMPLETE_SOLUTION_AR.md** | ุฏููู ุดุงูู ูุงูู |
| **test-csrf.html** | ุงุฎุชุจุงุฑ ุชูุงุนูู |

---

## ๐ฏ ููุฎุต ุณุฑูุน

```
1. ุฃุถู CSRF_SECRET ุฅูู .env          โ
2. ุฃุนุฏ ุชุดุบูู ุงูุณูุฑูุฑ                  โ
3. ุงุฎุชุจุฑ: curl .../csrf-diagnostic   โ
4. ุงูุณุฎ frontend helper ุงูููุงุณุจ      โ
5. ุงุณุชูุชุน! ๐                         โ
```

---

## ๐ก ูุตูุญุฉ ูููุฉ

**ููุชุฌุฑุจุฉ ุงูุณุฑูุนุฉ ููุท** (ููุณ ููุฅูุชุงุฌ!):

ุฃุถู ูุฐุง ุงูุณุทุฑ ุฅูู `.env` ูุชุนุทูู CSRF ูุคูุชุงู:
```bash
CSRF_DEV_BYPASS=true
```

โ๏ธ **ุชุญุฐูุฑ:** ุงุญุฐู ูุฐุง ุงูุณุทุฑ ูุจู ุงูุฅูุชุงุฌ!

---

## ๐ ุงูุฏุนู

ูู ูุญุชุงุฌ ูุณุงุนุฏุฉ:
1. ุดุบู: `/api/v1/auth/csrf-diagnostic`
2. ุงูุชุญ: `test-csrf.html`
3. ุงูุฑุฃ: `CSRF_QUICK_FIX.md`

---

**ููุช ุงูุชุทุจูู:** 3-5 ุฏูุงุฆู ููุท! โฑ๏ธ

**ุงูุตุนูุจุฉ:** ุณูู ุฌุฏุงู โญโโโโ

**ุงูุญุงูุฉ:** โ ุฌุงูุฒ 100%

๐ **ููุง ุงุจุฏุฃ ุงูุขู!** ๐
